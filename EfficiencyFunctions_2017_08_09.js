var rodSat = 35000;
var retinalE = [1, 3, 10, 30, 100, 300, 1000, 3000, 10000, 30000, 100000];
var pupilDiam = [7.1, 7, 6.9, 6.8, 6.7, 6.5, 6.3, 5.65, 5, 3.65, 2.3];

function efficienyFunctions(wavelength, thickness){
	var results = new Object;
	
	var Vlambda = {
		wavelength: [390,392,394,396,398,400,402,404,406,408,410,412,414,416,418,420,422,424,426,428,430,432,434,436,438,440,442,444,446,448,450,452,454,456,458,460,462,464,466,468,470,472,474,476,478,480,482,484,486,488,490,492,494,496,498,500,502,504,506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,564,566,568,570,572,574,576,578,580,582,584,586,588,590,592,594,596,598,600,602,604,606,608,610,612,614,616,618,620,622,624,626,628,630,632,634,636,638,640,642,644,646,648,650,652,654,656,658,660,662,664,666,668,670,672,674,676,678,680,682,684,686,688,690,692,694,696,698,700,702,704,706,708,710,712,714,716,718,720,722,724,726,728,730],
		value: [0.000120024,0.000151522,0.000191854,0.000246955,0.000318583,0.000396078,0.000473117,0.000572332,0.000724703,0.000941346,0.001210239,0.001531054,0.001935705,0.002455285,0.003118416,0.00400079,0.005160339,0.006547453,0.008088105,0.00976961,0.011602292,0.013585404,0.015718195,0.018010918,0.020457961,0.023004545,0.0256153,0.028356852,0.031317017,0.034527941,0.038007508,0.041776253,0.045851728,0.050253608,0.054991424,0.060011855,0.065290418,0.070925101,0.077031218,0.083683332,0.090997977,0.09906541,0.107905917,0.117555223,0.12801809,0.139047469,0.150499031,0.162749851,0.176277924,0.191311294,0.208061102,0.2267793,0.2475301,0.270238286,0.295108799,0.323063821,0.354755882,0.389364419,0.425714,0.463485962,0.503099387,0.54461959,0.587081278,0.629478954,0.671007758,0.710140288,0.745610895,0.777990492,0.808270074,0.836472045,0.862170322,0.885137259,0.905622106,0.92391732,0.940108318,0.9541885,0.966198272,0.976215351,0.984286846,0.990508475,0.995146691,0.998295513,0.999945739,1.000054261,0.998522758,0.995196601,0.989938162,0.982918276,0.974276168,0.964047248,0.952188105,0.938684637,0.923640065,0.907185615,0.889380497,0.870171902,0.849559831,0.827744821,0.804953719,0.781346355,0.757149575,0.732567119,0.707636294,0.682353999,0.656804152,0.631124679,0.605434003,0.57975243,0.554070557,0.528457197,0.503099387,0.478124854,0.453492788,0.429164782,0.40511203,0.381075281,0.356897705,0.332883361,0.309399222,0.286650228,0.265052361,0.244937987,0.226097466,0.20820273,0.19119297,0.175034578,0.159677944,0.145154575,0.131526283,0.118802669,0.107021142,0.096207646,0.086281895,0.077135878,0.068723656,0.061012053,0.053965701,0.047559045,0.041766971,0.036571065,0.032006323,0.028082188,0.024712932,0.021805078,0.01928489,0.017003359,0.014840112,0.012837316,0.011070497,0.009535195,0.008211622,0.007086824,0.006139698,0.005344115,0.004677328,0.004102811,0.003589808,0.003134712,0.00273868,0.002393717,0.002091413,0.001824941,0.001590501,0.00138477,0.00120433,0.001047207,0.000911289,0.000793395,0.000690963,0.000599614,0.000520103]
	};
	var Vprime = {
		wavelength: [390,392,394,396,398,400,402,404,406,408,410,412,414,416,418,420,422,424,426,428,430,432,434,436,438,440,442,444,446,448,450,452,454,456,458,460,462,464,466,468,470,472,474,476,478,480,482,484,486,488,490,492,494,496,498,500,502,504,506,508,510,512,514,516,518,520,522,524,526,528,530,532,534,536,538,540,542,544,546,548,550,552,554,556,558,560,562,564,566,568,570,572,574,576,578,580,582,584,586,588,590,592,594,596,598,600,602,604,606,608,610,612,614,616,618,620,622,624,626,628,630,632,634,636,638,640,642,644,646,648,650,652,654,656,658,660,662,664,666,668,670,672,674,676,678,680,682,684,686,688,690,692,694,696,698,700,702,704,706,708,710,712,714,716,718,720,722,724,726,728,730],
		value: [0.002209,0.002939,0.003921,0.00524,0.00698,0.00929,0.01231,0.01619,0.02113,0.0273,0.03484,0.0439,0.0545,0.0668,0.0808,0.0966,0.1141,0.1334,0.1541,0.1764,0.1998,0.2243,0.2496,0.2755,0.3017,0.3281,0.3543,0.3803,0.406,0.431,0.455,0.479,0.502,0.524,0.546,0.567,0.588,0.61,0.631,0.653,0.676,0.699,0.722,0.745,0.769,0.793,0.817,0.84,0.862,0.884,0.904,0.923,0.941,0.957,0.97,0.982,0.99,0.997,1,1,0.997,0.99,0.981,0.968,0.953,0.935,0.915,0.892,0.867,0.84,0.811,0.781,0.749,0.717,0.683,0.65,0.616,0.581,0.548,0.514,0.481,0.448,0.417,0.3864,0.3569,0.3288,0.3018,0.2762,0.2519,0.2291,0.2076,0.1876,0.169,0.1517,0.1358,0.1212,0.1078,0.0956,0.0845,0.0745,0.0655,0.0574,0.0502,0.0438,0.03816,0.03315,0.02874,0.02487,0.02147,0.01851,0.01593,0.01369,0.01175,0.01007,0.00862,0.00737,0.0063,0.00538,0.00459,0.003913,0.003335,0.002842,0.002421,0.002062,0.001757,0.001497,0.001276,0.001088,0.000928,0.000792,0.000677,0.000579,0.000496,0.000425,0.0003645,0.0003129,0.0002689,0.0002313,0.0001991,0.0001716,0.000148,0.0001277,0.0001104,0.0000954,0.0000826,0.0000715,0.000062,0.0000538,0.0000467,0.0000406,0.00003533,0.00003075,0.00002679,0.00002336,0.00002038,0.0000178,0.00001556,0.0000136,0.00001191,0.00001043,0.00000914,0.00000802,0.00000704,0.00000618,0.00000544,0.00000478,0.00000421,0.000003709,0.00000327,0.000002884,0.000002546]
	};
	var Scone = {
		wavelength: [3.90E+02,3.92E+02,3.94E+02,3.96E+02,3.98E+02,4.00E+02,4.02E+02,4.04E+02,4.06E+02,4.08E+02,4.10E+02,4.12E+02,4.14E+02,4.16E+02,4.18E+02,4.20E+02,4.22E+02,4.24E+02,4.26E+02,4.28E+02,4.30E+02,4.32E+02,4.34E+02,4.36E+02,4.38E+02,4.40E+02,4.42E+02,4.44E+02,4.46E+02,4.48E+02,4.50E+02,4.52E+02,4.54E+02,4.56E+02,4.58E+02,4.60E+02,4.62E+02,4.64E+02,4.66E+02,4.68E+02,4.70E+02,4.72E+02,4.74E+02,4.76E+02,4.78E+02,4.80E+02,4.82E+02,4.84E+02,4.86E+02,4.88E+02,4.90E+02,4.92E+02,4.94E+02,4.96E+02,4.98E+02,5.00E+02,5.02E+02,5.04E+02,5.06E+02,5.08E+02,5.10E+02,5.12E+02,5.14E+02,5.16E+02,5.18E+02,5.20E+02,5.22E+02,5.24E+02,5.26E+02,5.28E+02,5.30E+02,5.32E+02,5.34E+02,5.36E+02,5.38E+02,5.40E+02,5.42E+02,5.44E+02,5.46E+02,5.48E+02,5.50E+02,5.52E+02,5.54E+02,5.56E+02,5.58E+02,5.60E+02,5.62E+02,5.64E+02,5.66E+02,5.68E+02,5.70E+02,5.72E+02,5.74E+02,5.76E+02,5.78E+02,5.80E+02,5.82E+02,5.84E+02,5.86E+02,5.88E+02,5.90E+02,5.92E+02,5.94E+02,5.96E+02,5.98E+02,6.00E+02,6.02E+02,6.04E+02,6.06E+02,6.08E+02,6.10E+02,6.12E+02,6.14E+02,6.16E+02,6.18E+02,6.20E+02,6.22E+02,6.24E+02,6.26E+02,6.28E+02,6.30E+02,6.32E+02,6.34E+02,6.36E+02,6.38E+02,6.40E+02,6.42E+02,6.44E+02,6.46E+02,6.48E+02,6.50E+02,6.52E+02,6.54E+02,6.56E+02,6.58E+02,6.60E+02,6.62E+02,6.64E+02,6.66E+02,6.68E+02,6.70E+02,6.72E+02,6.74E+02,6.76E+02,6.78E+02,6.80E+02,6.82E+02,6.84E+02,6.86E+02,6.88E+02,6.90E+02,6.92E+02,6.94E+02,6.96E+02,6.98E+02,7.00E+02,7.02E+02,7.04E+02,7.06E+02,7.08E+02,7.10E+02,7.12E+02,7.14E+02,7.16E+02,7.18E+02,7.20E+02,7.22E+02,7.24E+02,7.26E+02,7.28E+02,7.30E+02],
		value: [7.77E-03,4.10E-02,7.43E-02,1.08E-01,1.41E-01,1.74E-01,2.12E-01,2.50E-01,2.87E-01,3.25E-01,3.63E-01,4.23E-01,4.82E-01,5.42E-01,6.02E-01,6.61E-01,7.10E-01,7.59E-01,8.07E-01,8.56E-01,9.04E-01,9.24E-01,9.43E-01,9.62E-01,9.81E-01,1.00E+00,9.83E-01,9.66E-01,9.50E-01,9.33E-01,9.16E-01,8.93E-01,8.70E-01,8.48E-01,8.25E-01,8.02E-01,7.80E-01,7.58E-01,7.37E-01,7.15E-01,6.93E-01,6.48E-01,6.04E-01,5.59E-01,5.15E-01,4.70E-01,4.32E-01,3.93E-01,3.54E-01,3.16E-01,2.77E-01,2.55E-01,2.32E-01,2.10E-01,1.87E-01,1.65E-01,1.51E-01,1.37E-01,1.23E-01,1.09E-01,9.56E-02,8.59E-02,7.63E-02,6.67E-02,5.70E-02,4.74E-02,4.30E-02,3.87E-02,3.43E-02,3.00E-02,2.56E-02,2.30E-02,2.04E-02,1.77E-02,1.51E-02,1.24E-02,1.10E-02,9.63E-03,8.24E-03,6.84E-03,5.44E-03,4.82E-03,4.20E-03,3.57E-03,2.95E-03,2.33E-03,2.18E-03,2.02E-03,1.86E-03,1.71E-03,1.55E-03,1.40E-03,1.24E-03,1.09E-03,9.32E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,7.77E-04,6.22E-04,4.66E-04,3.11E-04,1.55E-04,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00]
	};
	var Macula = {
		wavelength: [4.00E+02,4.05E+02,4.10E+02,4.15E+02,4.20E+02,4.25E+02,4.30E+02,4.35E+02,4.40E+02,4.45E+02,4.50E+02,4.55E+02,4.60E+02,4.65E+02,4.70E+02,4.75E+02,4.80E+02,4.85E+02,4.90E+02,4.95E+02,5.00E+02,5.05E+02,5.10E+02,5.15E+02,5.20E+02,5.25E+02,5.30E+02,5.35E+02,5.40E+02,5.45E+02,5.50E+02,5.55E+02,5.60E+02,5.65E+02,5.70E+02,5.75E+02,5.80E+02,5.85E+02,5.90E+02,5.95E+02,6.00E+02,6.05E+02,6.10E+02,6.15E+02,6.20E+02,6.25E+02,6.30E+02,6.35E+02,6.40E+02,6.45E+02,6.50E+02,6.55E+02,6.60E+02,6.65E+02,6.70E+02,6.75E+02,6.80E+02,6.85E+02,6.90E+02,6.95E+02,7.00E+02,7.05E+02,7.10E+02,7.15E+02,7.20E+02,7.25E+02,7.30E+02],
		value: [2.24E-01,2.44E-01,2.64E-01,2.83E-01,3.14E-01,3.53E-01,3.83E-01,4.00E-01,4.17E-01,4.40E-01,4.66E-01,4.90E-01,5.00E-01,4.83E-01,4.62E-01,4.38E-01,4.37E-01,4.36E-01,4.27E-01,4.04E-01,3.51E-01,2.83E-01,2.14E-01,1.55E-01,9.60E-02,6.80E-02,4.00E-02,2.85E-02,1.70E-02,1.30E-02,9.00E-03,8.50E-03,8.00E-03,6.50E-03,5.00E-03,4.50E-03,4.00E-03,2.00E-03,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00]
	};
	var Melanopsin = {
		wavelength: [3.80E+02,3.81E+02,3.82E+02,3.83E+02,3.84E+02,3.85E+02,3.86E+02,3.87E+02,3.88E+02,3.89E+02,3.90E+02,3.91E+02,3.92E+02,3.93E+02,3.94E+02,3.95E+02,3.96E+02,3.97E+02,3.98E+02,3.99E+02,4.00E+02,4.01E+02,4.02E+02,4.03E+02,4.04E+02,4.05E+02,4.06E+02,4.07E+02,4.08E+02,4.09E+02,4.10E+02,4.11E+02,4.12E+02,4.13E+02,4.14E+02,4.15E+02,4.16E+02,4.17E+02,4.18E+02,4.19E+02,4.20E+02,4.21E+02,4.22E+02,4.23E+02,4.24E+02,4.25E+02,4.26E+02,4.27E+02,4.28E+02,4.29E+02,4.30E+02,4.31E+02,4.32E+02,4.33E+02,4.34E+02,4.35E+02,4.36E+02,4.37E+02,4.38E+02,4.39E+02,4.40E+02,4.41E+02,4.42E+02,4.43E+02,4.44E+02,4.45E+02,4.46E+02,4.47E+02,4.48E+02,4.49E+02,4.50E+02,4.51E+02,4.52E+02,4.53E+02,4.54E+02,4.55E+02,4.56E+02,4.57E+02,4.58E+02,4.59E+02,4.60E+02,4.61E+02,4.62E+02,4.63E+02,4.64E+02,4.65E+02,4.66E+02,4.67E+02,4.68E+02,4.69E+02,4.70E+02,4.71E+02,4.72E+02,4.73E+02,4.74E+02,4.75E+02,4.76E+02,4.77E+02,4.78E+02,4.79E+02,4.80E+02,4.81E+02,4.82E+02,4.83E+02,4.84E+02,4.85E+02,4.86E+02,4.87E+02,4.88E+02,4.89E+02,4.90E+02,4.91E+02,4.92E+02,4.93E+02,4.94E+02,4.95E+02,4.96E+02,4.97E+02,4.98E+02,4.99E+02,5.00E+02,5.01E+02,5.02E+02,5.03E+02,5.04E+02,5.05E+02,5.06E+02,5.07E+02,5.08E+02,5.09E+02,5.10E+02,5.11E+02,5.12E+02,5.13E+02,5.14E+02,5.15E+02,5.16E+02,5.17E+02,5.18E+02,5.19E+02,5.20E+02,5.21E+02,5.22E+02,5.23E+02,5.24E+02,5.25E+02,5.26E+02,5.27E+02,5.28E+02,5.29E+02,5.30E+02,5.31E+02,5.32E+02,5.33E+02,5.34E+02,5.35E+02,5.36E+02,5.37E+02,5.38E+02,5.39E+02,5.40E+02,5.41E+02,5.42E+02,5.43E+02,5.44E+02,5.45E+02,5.46E+02,5.47E+02,5.48E+02,5.49E+02,5.50E+02,5.51E+02,5.52E+02,5.53E+02,5.54E+02,5.55E+02,5.56E+02,5.57E+02,5.58E+02,5.59E+02,5.60E+02,5.61E+02,5.62E+02,5.63E+02,5.64E+02,5.65E+02,5.66E+02,5.67E+02,5.68E+02,5.69E+02,5.70E+02,5.71E+02,5.72E+02,5.73E+02,5.74E+02,5.75E+02,5.76E+02,5.77E+02,5.78E+02,5.79E+02,5.80E+02,5.81E+02,5.82E+02,5.83E+02,5.84E+02,5.85E+02,5.86E+02,5.87E+02,5.88E+02,5.89E+02,5.90E+02,5.91E+02,5.92E+02,5.93E+02,5.94E+02,5.95E+02,5.96E+02,5.97E+02,5.98E+02,5.99E+02,6.00E+02,6.01E+02,6.02E+02,6.03E+02,6.04E+02,6.05E+02,6.06E+02,6.07E+02,6.08E+02,6.09E+02,6.10E+02,6.11E+02,6.12E+02,6.13E+02,6.14E+02,6.15E+02,6.16E+02,6.17E+02,6.18E+02,6.19E+02,6.20E+02,6.21E+02,6.22E+02,6.23E+02,6.24E+02,6.25E+02,6.26E+02,6.27E+02,6.28E+02,6.29E+02,6.30E+02,6.31E+02,6.32E+02,6.33E+02,6.34E+02,6.35E+02,6.36E+02,6.37E+02,6.38E+02,6.39E+02,6.40E+02,6.41E+02,6.42E+02,6.43E+02,6.44E+02,6.45E+02,6.46E+02,6.47E+02,6.48E+02,6.49E+02,6.50E+02,6.51E+02,6.52E+02,6.53E+02,6.54E+02,6.55E+02,6.56E+02,6.57E+02,6.58E+02,6.59E+02,6.60E+02,6.61E+02,6.62E+02,6.63E+02,6.64E+02,6.65E+02,6.66E+02,6.67E+02,6.68E+02,6.69E+02,6.70E+02,6.71E+02,6.72E+02,6.73E+02,6.74E+02,6.75E+02,6.76E+02,6.77E+02,6.78E+02,6.79E+02,6.80E+02,6.81E+02,6.82E+02,6.83E+02,6.84E+02,6.85E+02,6.86E+02,6.87E+02,6.88E+02,6.89E+02,6.90E+02,6.91E+02,6.92E+02,6.93E+02,6.94E+02,6.95E+02,6.96E+02,6.97E+02,6.98E+02,6.99E+02,7.00E+02,7.01E+02,7.02E+02,7.03E+02,7.04E+02,7.05E+02,7.06E+02,7.07E+02,7.08E+02,7.09E+02,7.10E+02,7.11E+02,7.12E+02,7.13E+02,7.14E+02,7.15E+02,7.16E+02,7.17E+02,7.18E+02,7.19E+02,7.20E+02,7.21E+02,7.22E+02,7.23E+02,7.24E+02,7.25E+02,7.26E+02,7.27E+02,7.28E+02,7.29E+02,7.30E+02],
		value: [1.21E-03,1.52E-03,1.88E-03,2.27E-03,2.71E-03,3.20E-03,3.74E-03,4.35E-03,4.88E-03,5.46E-03,6.09E-03,7.54E-03,9.10E-03,1.08E-02,1.26E-02,1.45E-02,1.66E-02,1.88E-02,2.11E-02,2.34E-02,2.59E-02,3.06E-02,3.54E-02,4.05E-02,4.59E-02,5.15E-02,5.73E-02,6.33E-02,7.01E-02,7.71E-02,8.44E-02,9.44E-02,1.05E-01,1.15E-01,1.26E-01,1.37E-01,1.49E-01,1.61E-01,1.74E-01,1.88E-01,2.02E-01,2.18E-01,2.34E-01,2.50E-01,2.66E-01,2.83E-01,3.00E-01,3.17E-01,3.35E-01,3.54E-01,3.72E-01,3.88E-01,4.04E-01,4.20E-01,4.36E-01,4.52E-01,4.68E-01,4.85E-01,5.02E-01,5.20E-01,5.38E-01,5.51E-01,5.64E-01,5.77E-01,5.91E-01,6.05E-01,6.19E-01,6.33E-01,6.47E-01,6.62E-01,6.76E-01,6.89E-01,7.01E-01,7.14E-01,7.27E-01,7.41E-01,7.54E-01,7.67E-01,7.82E-01,7.96E-01,8.10E-01,8.22E-01,8.34E-01,8.45E-01,8.57E-01,8.69E-01,8.80E-01,8.91E-01,9.01E-01,9.11E-01,9.21E-01,9.31E-01,9.41E-01,9.49E-01,9.57E-01,9.65E-01,9.72E-01,9.79E-01,9.84E-01,9.89E-01,9.94E-01,9.97E-01,9.99E-01,1.00E+00,1.00E+00,1.00E+00,9.99E-01,9.97E-01,9.95E-01,9.92E-01,9.89E-01,9.85E-01,9.81E-01,9.75E-01,9.69E-01,9.62E-01,9.54E-01,9.46E-01,9.37E-01,9.28E-01,9.17E-01,9.06E-01,8.95E-01,8.83E-01,8.71E-01,8.58E-01,8.44E-01,8.30E-01,8.16E-01,8.01E-01,7.86E-01,7.69E-01,7.53E-01,7.36E-01,7.19E-01,7.01E-01,6.84E-01,6.67E-01,6.50E-01,6.32E-01,6.14E-01,5.97E-01,5.80E-01,5.63E-01,5.45E-01,5.28E-01,5.11E-01,4.94E-01,4.77E-01,4.60E-01,4.44E-01,4.28E-01,4.12E-01,3.97E-01,3.81E-01,3.66E-01,3.52E-01,3.38E-01,3.24E-01,3.10E-01,2.97E-01,2.84E-01,2.71E-01,2.59E-01,2.47E-01,2.35E-01,2.24E-01,2.13E-01,2.03E-01,1.93E-01,1.83E-01,1.74E-01,1.64E-01,1.56E-01,1.47E-01,1.39E-01,1.32E-01,1.24E-01,1.17E-01,1.11E-01,1.04E-01,9.82E-02,9.24E-02,8.69E-02,8.16E-02,7.66E-02,7.19E-02,6.74E-02,6.32E-02,5.92E-02,5.54E-02,5.18E-02,4.84E-02,4.53E-02,4.23E-02,3.95E-02,3.68E-02,3.44E-02,3.20E-02,2.98E-02,2.78E-02,2.59E-02,2.41E-02,2.24E-02,2.08E-02,1.93E-02,1.79E-02,1.66E-02,1.54E-02,1.43E-02,1.33E-02,1.23E-02,1.14E-02,1.05E-02,9.76E-03,9.03E-03,8.35E-03,7.72E-03,7.15E-03,6.61E-03,6.11E-03,5.65E-03,5.22E-03,4.83E-03,4.46E-03,4.12E-03,3.80E-03,3.51E-03,3.25E-03,3.00E-03,2.77E-03,2.56E-03,2.36E-03,2.18E-03,2.01E-03,1.86E-03,1.72E-03,1.58E-03,1.46E-03,1.35E-03,1.25E-03,1.16E-03,1.07E-03,9.86E-04,9.12E-04,8.43E-04,7.79E-04,7.21E-04,6.67E-04,6.17E-04,5.71E-04,5.29E-04,4.90E-04,4.54E-04,4.20E-04,3.90E-04,3.61E-04,3.35E-04,3.11E-04,2.88E-04,2.67E-04,2.48E-04,2.30E-04,2.14E-04,1.99E-04,1.84E-04,1.71E-04,1.59E-04,1.48E-04,1.38E-04,1.28E-04,1.19E-04,1.11E-04,1.03E-04,9.58E-05,8.92E-05,8.30E-05,7.73E-05,7.20E-05,6.71E-05,6.25E-05,5.82E-05,5.43E-05,5.06E-05,4.71E-05,4.40E-05,4.10E-05,3.82E-05,3.57E-05,3.33E-05,3.11E-05,2.90E-05,2.71E-05,2.53E-05,2.36E-05,2.21E-05,2.06E-05,1.93E-05,1.80E-05,1.68E-05,1.57E-05,1.47E-05,1.38E-05,1.29E-05,1.21E-05,1.13E-05,1.06E-05,9.90E-06,9.27E-06,8.68E-06,8.13E-06,7.62E-06,7.14E-06,6.69E-06,6.28E-06,5.89E-06,5.52E-06,5.17E-06,4.86E-06,4.56E-06,4.28E-06,4.02E-06,3.77E-06,3.54E-06,3.32E-06,3.12E-06,2.93E-06,2.76E-06,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00,0.00E+00]
	};
	
	//var thickness = 1.0;
	var macularT = arrayPow(10,arrayScalar(Macula.value,-thickness));
	var macularTi = interp1(Macula.wavelength,macularT,wavelength,1);
	
	var VprimeInt1 = interp1(Vprime.wavelength,Vprime.value,wavelength,0);
	var VprimeInt = arrayNormalize(VprimeInt1);
	
	var MelanopsinInt1 = interp1(Melanopsin.wavelength,Melanopsin.value,wavelength,0);
	var MelanopsinInt = arrayNormalize(MelanopsinInt1);
	
	var SconeInt1 = interp1(Scone.wavelength,Scone.value,wavelength,0);
	var SconeInt2 = arrayDiv(SconeInt1,macularTi);
	var SconeInt = arrayNormalize(SconeInt2);
	
	var VlambdaInt1 = interp1(Vlambda.wavelength,Vlambda.value,wavelength,0);
	var VlambdaInt2 = arrayDiv(VlambdaInt1,macularTi);
	var VlambdaInt = arrayNormalize(VlambdaInt2);
	var PhotopicInt = arrayNormalize(VlambdaInt1);
	
	results = {
		Vlambda: VlambdaInt,
		Vprime: VprimeInt,
		Scone: SconeInt,
		Melanopsin: MelanopsinInt,
		Photopic: PhotopicInt
	};
	return results;
}